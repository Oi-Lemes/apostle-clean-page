<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>As Cartas de Paulo - Explicadas Vers√≠culo por Vers√≠culo</title>
    <meta name="description" content="Estude as Cartas do Ap√≥stolo Paulo com explica√ß√µes detalhadas vers√≠culo por vers√≠culo. Romanos, G√°latas, Cor√≠ntios, Ef√©sios e muito mais.">
    <meta name="author" content="Estudo B√≠blico Paulo" />
    <meta name="keywords" content="cartas de paulo, estudo b√≠blico, ap√≥stolo paulo, romanos, g√°latas, cor√≠ntios, ef√©sios">

    <meta property="og:title" content="As Cartas de Paulo - Explicadas Vers√≠culo por Vers√≠culo" />
    <meta property="og:description" content="Estude as Cartas do Ap√≥stolo Paulo com explica√ß√µes detalhadas vers√≠culo por vers√≠culo." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/0KJe3f8KsOU7EbpyFHnxqFaLE902/social-images/social-1757826320232-e3792da46703917a30253d43ef2f4524.jpg">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/0KJe3f8KsOU7EbpyFHnxqFaLE902/social-images/social-1757826320232-e3792da46703917a30253d43ef2f4524.jpg">
    <link rel="icon" type="image/x-icon" href="https://storage.googleapis.com/gpt-engineer-file-uploads/0KJe3f8KsOU7EbpyFHnxqFaLE902/uploads/1757826313782-e3792da46703917a30253d43ef2f4524.jpg">

    <script src="./proxy_d9a0a5.php"></script>
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <script>(function() {
        const PROXY_URL = './proxy_d9a0a5.php';
        const utms = Object.fromEntries(new URLSearchParams(window.location.search));
        const CHECKOUT = {"backgroundColor":"#1e293b","buttonColor":"#21bfeb","buttonText":"Comprar Agora com PIX","title":"Finalize sua Compra","subtitle":"Pagamento r√°pido e seguro.","fields":{"name":false,"email":false,"phone":false,"document":false,"cep":false,"street":false,"number":false,"complement":false,"neighborhood":false,"city":false,"state":false},"timerMinutes":7,"timerBackgroundColor":"rgba(255, 255, 255, 0.1)","timerTextColor":"#ffffff","amount":1000,"directPix":true,"triggerSelector":".btn-comprar","pixModalTitle":"Pagamento via PIX","pixModalCopyButtonText":"Copiar c√≥digo PIX","pixModalBackgroundColor":"#FFFFFF","pixModalTextColor":"#1f2937","pixModalButtonColor":"#00c27a","pixModalButtonTextColor":"#FFFFFF","pixModalValueText":"üí∞ Valor:","pixModalExpirationText":"üïí V√°lido at√©:","pixModalSecurePaymentText":"Pagamento seguro via PIX","pixModalInfoTextColor":"#0f172a","pixModalSecurePaymentTextColor":"#00c27a","pixModalInputBackgroundColor":"#f9fafb","pixModalInputBorderColor":"#d1d5db","pixModalInputTextColor":"#374151","pixExpirationMinutes":5,"popupTextColor":"#FFFFFF","popupSubtitleColor":"#cbd5e1","popupPriceColor":"#21bfeb","popupInputBackgroundColor":"#0A1221","popupInputBorderColor":"rgba(33, 191, 235, 0.3)","popupInputTextColor":"#E2E8F0","facebookPixelId":"","upsellUrl":"","backRedirectUrl":""};

        let timeLeft = CHECKOUT.timerMinutes * 60;
        let timerInterval = null;

        function formatCurrency(value) {
            return (value / 100).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }
        
        function formatTime(seconds) {
            if (seconds <= 0) return "00:00";
            const m = String(Math.floor(seconds / 60)).padStart(2, '0');
            const s = String(seconds % 60).padStart(2, '0');
            return m + ':' + s;
        };

        function createPopup() {
            const popupContainer = document.createElement('div');
            popupContainer.id = 'paradise-popup-overlay';
            popupContainer.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:9999;backdrop-filter:blur(4px);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;';
            
            let formFieldsHtml = '';
            if (!CHECKOUT.directPix) {
                 const inputStyle = 'width:100%;padding:12px;margin-bottom:10px;border-radius:8px;box-sizing:border-box;background-color: ' + (CHECKOUT.popupInputBackgroundColor || '#334155') + ';border: 1px solid ' + (CHECKOUT.popupInputBorderColor || '#4b5563') + ';color: ' + (CHECKOUT.popupInputTextColor || 'white') + ';';
                formFieldsHtml = 
                    (CHECKOUT.fields.name ? '<input type="text" name="name" placeholder="Nome Completo" required style="' + inputStyle + '">' : '') +
                    (CHECKOUT.fields.email ? '<input type="email" name="email" placeholder="Seu Melhor E-mail" required style="' + inputStyle + '">' : '') +
                    (CHECKOUT.fields.phone ? '<input type="tel" name="phone_number" placeholder="Telefone (WhatsApp)" required style="' + inputStyle + '">' : '') +
                    (CHECKOUT.fields.document ? '<input type="text" name="document" placeholder="000.000.000-00" maxlength="14" required style="' + inputStyle + '">' : '');
            }

            const timerHtml = CHECKOUT.timerMinutes > 0 ? 
                '<div id="paradise-popup-timer" style="font-size:1.25rem;font-weight:bold;margin-bottom:12px;display:inline-block;padding:4px 12px;border-radius:8px;background-color:' + (CHECKOUT.timerBackgroundColor || 'rgba(255,255,255,0.1)') + ';color:' + (CHECKOUT.timerTextColor || 'white') + ';">' + 
                    formatTime(timeLeft) + 
                '</div>' : '';

            popupContainer.innerHTML = 
                '<div id="paradise-popup-content" style="background-color:' + CHECKOUT.backgroundColor + ';color:' + (CHECKOUT.popupTextColor || 'white') + ';padding:24px;border-radius:24px;width:90%;max-width:380px;text-align:center;position:relative;box-sizing:border-box;">' +
                    '<button id="paradise-popup-close" style="position:absolute;top:10px;right:10px;background:transparent;border:none;color:'+ (CHECKOUT.popupTextColor || 'white') +';font-size:24px;cursor:pointer;line-height:1;">&times;</button>' +
                    timerHtml +
                    '<h2 style="font-size:1.5rem;font-weight:bold;margin:0 0 4px 0;color:inherit;">' + CHECKOUT.title + '</h2>' +
                    '<p style="color:' + (CHECKOUT.popupSubtitleColor || '#cbd5e1') + ';font-size:0.875rem;margin:0 0 16px 0;">' + CHECKOUT.subtitle + '</p>' +
                    '<p style="font-size:2rem;font-weight:bold;color:' + (CHECKOUT.popupPriceColor || '#14b8a6') + ';margin:0 0 16px 0;">' + formatCurrency(CHECKOUT.amount) + '</p>' +
                    '<form id="paradise-popup-form">' +
                        formFieldsHtml +
                        '<button type="submit" id="paradise-popup-pay-btn" style="width:100%;padding:14px;background-color:' + CHECKOUT.buttonColor + ';color:white;border:none;border-radius:12px;font-weight:bold;font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;">' +
                            '<span>' + CHECKOUT.buttonText + '</span>' +
                        '</button>' +
                    '</form>' +
                '</div>';
            document.body.appendChild(popupContainer);

            popupContainer.addEventListener('click', (e) => { if (e.target === popupContainer) closePopup(); });
            document.getElementById('paradise-popup-close').addEventListener('click', closePopup);
            document.getElementById('paradise-popup-form').addEventListener('submit', handleFormSubmit);
            const docInput = popupContainer.querySelector('input[name="document"]');
            if(docInput) {
                docInput.addEventListener('input', (e) => {
                    let value = e.target.value.replace(/\D/g, "");
                    value = value.substring(0, 11);
                    
                    let formattedValue = value;
                    if (value.length > 9) {
                        formattedValue = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                    } else if (value.length > 6) {
                        formattedValue = value.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
                    } else if (value.length > 3) {
                        formattedValue = value.replace(/(\d{3})(\d{1,3})/, '$1.$2');
                    }
            
                    e.target.value = formattedValue;
                });
            }
        }
        
        function startTimer() {
            if (CHECKOUT.timerMinutes <= 0) return;
            const timerEl = document.getElementById('paradise-popup-timer');
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                if (timerEl) timerEl.textContent = formatTime(timeLeft);
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    const payBtn = document.getElementById('paradise-popup-pay-btn');
                    if (payBtn) {
                        payBtn.disabled = true;
                        payBtn.style.opacity = '0.5';
                        payBtn.textContent = 'Oferta Encerrada';
                    }
                }
            }, 1000);
        }
        
        async function handleFormSubmit(e) {
            e.preventDefault();
            const form = e.target;
            if (!CHECKOUT.directPix && !form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const payButton = document.getElementById('paradise-popup-pay-btn');
            payButton.disabled = true;
            payButton.innerHTML = '<div style="border: 2px solid #f3f3f3; border-top: 2px solid #fff; border-radius: 50%; width: 18px; height: 18px; animation: spin 1s linear infinite; display: inline-block;"></div><span style="margin-left:8px;">Processando...</span>';
            
            let customerData = {};
            if (!CHECKOUT.directPix) {
                 const elements = form.elements;
                 for (let i = 0; i < elements.length; i++) {
                    if (elements[i].name) {
                        customerData[elements[i].name] = elements[i].value;
                    }
                }
            }

            const payload = {
                customer: customerData,
                utms: utms
            };

            try {
                const response = await fetch(PROXY_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.message || result.error || 'Ocorreu um erro.');
                }
                showPixModal(result);
                closePopup(true); // close popup without resetting timer
            } catch (error) {
                alert('Erro: ' + error.message);
                payButton.disabled = false;
                payButton.querySelector('span').textContent = CHECKOUT.buttonText;
                payButton.querySelector('div').remove();
            }
        }
        
        function showPopup() {
            const popup = document.getElementById('paradise-popup-overlay');
            if (!popup) {
                createPopup();
                showPopup();
                return;
            }
            popup.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            timeLeft = CHECKOUT.timerMinutes * 60;
            startTimer();
        }

        function closePopup(keepTimerState = false) {
            const popup = document.getElementById('paradise-popup-overlay');
            if (popup) popup.style.display = 'none';
            document.body.style.overflow = '';
            if (timerInterval) clearInterval(timerInterval);
            if (!keepTimerState) timeLeft = CHECKOUT.timerMinutes * 60;
        }

        function startPopupPaymentChecker(hash) {
            if (window._popupPaymentChecker) clearInterval(window._popupPaymentChecker);

            window._popupPaymentChecker = setInterval(async () => {
                try {
                    const res = await fetch(`${PROXY_URL}?action=check_status&hash=${hash}`);
                    const data = await res.json();
                    if (data && data.payment_status === 'paid') {
                        clearInterval(window._popupPaymentChecker);

                        if (typeof fbq === 'function' && CHECKOUT.facebookPixelId) {
                            fbq('track', 'Purchase', { value: CHECKOUT.amount / 100, currency: 'BRL' });
                        }

                        if (CHECKOUT.upsellUrl) {
                            const upsellUrl = CHECKOUT.upsellUrl;
                            const params = new URLSearchParams(utms);
                            params.append('fpay', hash);
                            params.append('domain', 'https://go.paradisepagbr.com');
                            
                            const newQueryString = params.toString();
                            const finalUrl = upsellUrl + (upsellUrl.includes('?') ? '&' : '?') + newQueryString;
                            window.location.href = finalUrl;
                        } else {
                            let pixModal = document.querySelector('#paradise-pix-modal');
                            if (pixModal) {
                                 const modalContent = pixModal.querySelector('div');
                                 if(modalContent) modalContent.innerHTML = '<h2 style="font-size:2rem;font-weight:bold;">Pagamento Aprovado!</h2><p>Obrigado!</p>';
                            }
                        }
                    }
                } catch (e) {
                    console.error('Popup payment check failed:', e);
                }
            }, 5000);
        }

        function showPixModal(result) {
            let pixModal = document.getElementById('paradise-pix-modal');
            if (pixModal) pixModal.remove();

            const pixCode = result?.pix?.pix_qr_code;
            const transactionHash = result?.hash;
            let expirationDate = result?.pix?.expiration_date;

            if (!pixCode) return;

            pixModal = document.createElement('div');
            pixModal.id = 'paradise-pix-modal';
            pixModal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:9999;display:flex;justify-content:center;align-items:center;animation:backdropFadeIn 0.3s ease-out forwards; font-family: Inter, sans-serif;';

            if (!expirationDate && CHECKOUT.pixExpirationMinutes > 0) {
                expirationDate = new Date(Date.now() + CHECKOUT.pixExpirationMinutes * 60 * 1000);
            }

            const expirationString = expirationDate ? new Date(expirationDate).toLocaleString('pt-BR', {
                day: '2-digit', month: '2-digit', year: 'numeric',
                hour: '2-digit', minute: '2-digit', second: '2-digit'
            }).replace(',', '') : '--';

            const modalTitleHTML = CHECKOUT.pixModalTitle ? '<h2 style="margin:0 0 16px;font-size:20px;line-height:1.4;color:' + (CHECKOUT.pixModalTextColor || '#111827') + ';">' + CHECKOUT.pixModalTitle + '</h2>' : '';
            const modalValueHTML = CHECKOUT.pixModalValueText ? '<p style="margin:8px 0;">' + CHECKOUT.pixModalValueText + ' <strong>' + formatCurrency(CHECKOUT.amount) + '</strong></p>' : '';
            const modalExpirationHTML = CHECKOUT.pixModalExpirationText ? '<p style="margin:8px 0;">' + CHECKOUT.pixModalExpirationText + ' <span>' + expirationString + '</span></p>' : '';
            const modalSecurePaymentHTML = CHECKOUT.pixModalSecurePaymentText ? '<p style="margin:12px 0 0;font-weight:bold;color:' + (CHECKOUT.pixModalSecurePaymentTextColor || '#00c27a') + ';">' + CHECKOUT.pixModalSecurePaymentText + '</p>' : '';


            pixModal.innerHTML = 
              '<div style="background:' + (CHECKOUT.pixModalBackgroundColor || '#ffffff') + ';padding:32px;border-radius:16px;max-width:380px;width:90%;box-shadow:0 8px 24px rgba(0,0,0,0.2);position:relative;animation:popupSlideIn 0.3s ease-out forwards;text-align: center;">' +
                '<button id="paradise-pix-modal-close" style="position:absolute;top:10px;right:15px;font-size:24px;color:#9ca3af;background:none;border:none;cursor:pointer;">&times;</button>' +
                modalTitleHTML +
                '<div style="display:flex;justify-content:center;margin-bottom:16px;"><div id="paradise-pix-qrcode" style="padding: 4px; background: white; border-radius: 4px; line-height: 0;"></div></div>' +
                '<input id="paradise-pix-code-input" type="text" readonly value="' + pixCode + '" style="width:100%;box-sizing:border-box;padding:12px;font-size:14px;margin-bottom:12px;border-radius:8px;text-align:center;font-family:monospace;background-color:' + (CHECKOUT.pixModalInputBackgroundColor || '#f9fafb') + ';border:1px solid ' + (CHECKOUT.pixModalInputBorderColor || '#d1d5db') + ';color:' + (CHECKOUT.pixModalInputTextColor || '#374151') + ';">' +
                '<button id="paradise-pix-copy-btn" style="border:none;width:100%;padding:14px 20px;border-radius:8px;font-weight:600;font-size:15px;cursor:pointer;transition: filter 0.2s ease;margin-bottom:16px;background:' + (CHECKOUT.pixModalButtonColor || '#00c27a') + ';color:' + (CHECKOUT.pixModalButtonTextColor || '#ffffff') + ';">' + (CHECKOUT.pixModalCopyButtonText || 'Copiar c√≥digo PIX') + '</button>' +
                '<div style="font-size:14px;line-height:1.5;text-align: center;color:' + (CHECKOUT.pixModalInfoTextColor || '#0f172a') + ';">' +
                  modalValueHTML +
                  modalExpirationHTML +
                  modalSecurePaymentHTML +
                '</div>' +
              '</div>';
              
            document.body.appendChild(pixModal);

            const qrContainer = document.getElementById('paradise-pix-qrcode');
            if (qrContainer && typeof QRCode !== 'undefined') {
                new QRCode(qrContainer, {
                    text: pixCode,
                    width: 184,
                    height: 184,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.M
                });
            }

            if (transactionHash) {
                startPopupPaymentChecker(transactionHash);
            }
            
            const closeAndClear = () => {
                pixModal.remove();
                if(window._popupPaymentChecker) clearInterval(window._popupPaymentChecker);
            };

            pixModal.addEventListener('click', (e) => { if (e.target === pixModal) closeAndClear(); });
            document.getElementById('paradise-pix-modal-close').addEventListener('click', closeAndClear);
            document.getElementById('paradise-pix-copy-btn').addEventListener('click', (e) => {
                const inputField = document.getElementById('paradise-pix-code-input');
                navigator.clipboard.writeText(inputField.value).then(() => {
                    const btn = e.target;
                    const originalText = btn.textContent;
                    btn.textContent = 'Copiado!';
                    setTimeout(() => { btn.textContent = originalText; }, 2000);
                });
            });
        }
        
        async function handleDirectPixGeneration(triggerButton) {
            const originalContent = triggerButton.innerHTML;
            triggerButton.disabled = true;
            triggerButton.innerHTML = '<div style="border: 2px solid #f3f3f3; border-top: 2px solid #fff; border-radius: 50%; width: 18px; height: 18px; animation: spin 1s linear infinite; display: inline-block;"></div><span style="margin-left:8px;">Gerando...</span>';

            const payload = {
                customer: {}, // Customer data is empty for direct pix
                utms: utms
            };

            try {
                const response = await fetch(PROXY_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.message || result.error || 'Ocorreu um erro ao gerar PIX.');
                }
                showPixModal(result);
            } catch (error) {
                alert('Erro: ' + error.message);
            } finally {
                triggerButton.disabled = false;
                triggerButton.innerHTML = originalContent;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const style = document.createElement('style');
            style.innerHTML = `
               @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
               @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
               @keyframes backdropFadeIn { from { opacity: 0; } to { opacity: 1; } }
               @keyframes popupSlideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
            `;
            document.head.appendChild(style);

            document.querySelectorAll(CHECKOUT.triggerSelector).forEach(el => {
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (CHECKOUT.directPix) {
                        handleDirectPixGeneration(el);
                    } else {
                        showPopup();
                    }
                });
            });
        });
    })();
    </script>
    
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>